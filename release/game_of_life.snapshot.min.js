(function(){"use strict",window.GameOfLife=function(a,b){var c=GameOfLife,d=c.Support.parseCellGrid(a),e=c.Graphics(c.Support.validateCanvas(b),d);return{evolve:function(){function b(d){e.drawFrame(d,a++),nextGeneration=c.Generation.tick(d);_.isEqual(nextGeneration,d)||setTimeout(function(){b(nextGeneration)},10)}var a=0;b(d)}}}})(),function(a,b){function e(a){return b(a).chain().map(function(a,b){return[a,b]}).reduce(function(a,b){a[b[0]]=b[1];return a},{}).value()}function d(a){this.prototype=Error.prototype,this.name="InvalidArgument",this.message=a,this.toString=function(){return this.name+": "+this.message}}"use strict";var c={Alive:"*",Dead:"."};a.Support={InvalidArgument:d,CellTypes:c,invertObject:e,validateCanvas:function(a){if(!a||!b.isFunction(a.getContext))throw new d("Not a canvas element");return a},parseCellGrid:function(a){var c=a.split("\n");return b.map(c,function(a){return a.split("")})}}}(GameOfLife,_),function(a,b){"use strict";var c=a.Support.CellTypes;a.Graphics=function(a,d){function s(a){var b=(a+"").length*10+4;e.fillStyle="#ccc",e.fillRect(f-b,g-n,b,n),e.fillStyle="#555",e.fillText(a,o[0],o[1])}function r(a){e.fillStyle="#222",b.each(a,function(a,d){b.each(a,function(a,b){a===c.Alive&&e.fillRect(b*j+l,d*j+l,m,m)})})}function q(){var a,b;for(a=j+.5;a<f;a+=j)e.moveTo(a,0),e.lineTo(a,g);for(b=j+.5;b<g;b+=j)e.moveTo(0,b),e.lineTo(f,b);e.strokeStyle="#eee",e.stroke()}function p(){e.clearRect(0,0,f,g)}var e=a.getContext("2d"),f=a.width,g=a.height,h=d.length,i=d[0].length,j=f/i,k=j/2,l=2,m=j-l-1,n=16,o=[f-4,g-4];e.font="bold 10px sans-serif",e.textAlign="right",e.textBaseLine="top";return{drawFrame:function(a,b){p(),q(),r(a),s(b)}}}}(GameOfLife,_),function(a,b){function f(a,b){if(b<0||b>8)throw new d.InvalidArgument("Invalid number of alive neighbours. 0-8 expected.");return a===c.Dead?b==3:b===2||b===3}function e(a,d,e){var f=0,g=b.select([d-1,d,d+1],function(b){return b>=0&&b<a[0].length}),h=b.select([e-1,e,e+1],function(b){return b>=0&&b<a.length});b.each(g,function(g){b.each(h,function(b){(g!==d||b!==e)&&a[b][g]==c.Alive&&(f+=1)})});return f}"use strict";var c=a.Support.CellTypes,d=a.Support;a.Generation={tick:function(a){return b.map(a,function(d,g){return b.map(d,function(b,d){return f(b,e(a,d,g))?c.Alive:c.Dead})})},aliveNextRound:f,aliveNeighbours:e}}(GameOfLife,_)
